{% extends 'base.html' %}
{% load static %}

{% block title %}  {{ quiz.name }} - Questões {% endblock %}
{% block content %}

{%  if user.perfil.nome_completo %} <!-- Tendo perfil completo -->

<header class="masthead"> <!-- --> 
    {% block lgpd %}
            {% if not preferencias_salvas %}
                <div class="cookie-popup">
                    <div class="container px-4 px-lg-5"> 
                        <p> Utilizamos cookies para melhor experiência do usuário; 
                            Para conferir detalhadamente, por favor leia nossa <b> política de privacidade </b> </p>
                        <p> Ao ACEITAR estará concordando com os termos de uso de nosso portal. </p>
                        <p> <a href="javascript:void(0);" onclick="abrirPopup();"> Política de privacidade. </a></p>
                        <hr>
                        <form method="POST" action="{% url 'preference:aceitar_cookies' %}">
                        {% csrf_token %}
                            <div class="checkbox-group">
                                <input type="checkbox" id="essential_cookies" name="essential_cookies" checked disabled>
                                <label for="essential_cookies">Cookies Essenciais (Necessários)</label>
                            </div>
                                <div class="checkbox-group">
                                <input type="checkbox" id="analytics_cookies" name="analytics_cookies"checked >
                                <label for="analytics_cookies">Cookies de Análise (Análise de tráfego e estatísticas)</label>
                            </div>
                                <div class="checkbox-group">
                                <input type="checkbox" id="marketing_cookies" name="marketing_cookies" checked>
                                <label for="marketing_cookies">Cookies de Marketing (Conteúdo e exibição de anúncios)</label>
                            </div> 
                                <hr>
                                <div class="justify-content-center text-center">
                                <button class="btn btn-primary" type="submit"> Aceitar</button>
                            </div>
                        </form>
                    </div>
                </div>
            {% endif %}
        {% endblock %}
    
<div class="container justify-content-center"> <!-- justify-content-center h-100 -->
    <div class="row gx-4 gx-lg-5 marcador"> <!-- gx-4 gx-lg-5 bordered marcador --> 
        <div class="col-sm mt-1 marcador-topo"> 
            <h4 class="my-2"> Quiz: <span class="text-primary"> {{ quiz.name}} 
                <span class="timer float-end"> {{ request.user}} </span> 
            </h4>
            <h5 class="my-2"> Questões: <span class="cabecalho" data-pk="{{ quiz.pk }}"
                data-time="{{ quiz.time}}"
                data-index="{% url 'quizes:index' %}"
                data-url="{% url 'result:resultado' %}" 
                data-total="{{ quiz.number_of_questions}}"> {{ quiz.number_of_questions}}
            </span> 
            <span id="timer-box" class="timer float-end"> {{ quiz.time}}:00min </span> </h5>  
        </div>
       
        <div class="card border-dark marcador-container">
           
            {% for q in questions %}
                <h4 class="card-header border-dark bg-primary text-white text-center mt-2" name="question"> {{ q.text }}? </h4> <hr>
                <form id="post-form">
                    {% csrf_token %}
                    <div class="card-body mt-0"> 
                        {% for a in q.answer_set.all %}
                            <h6 class="text-dark"> <label for="{{ q.text }}"> <b> {{ a.text }} </b> </label>   </h6>
                            <select class="form-control" name="answer"> 
                                <option class="form-control" id="opDominante" name="opDominante"  value="1"> 1 </option>
                                <option class="form-control" id="opInfluente" name="opInfluente"  value="2"> 2 </option>
                                <option class="form-control" id="opEstavel"   name="opEstavel"    value="3"> 3 </option>
                                <option class="form-control" id="opCauteloso" name="opCauteloso"  value="4"> 4 </option>
                            </select> <hr>
                        {% endfor %}
                    </div><!-- fim div card-body-->
                </form> 
            {% endfor %} 
                 
            <!-- MENSAGENS DE ERRO VIA JS-->
            <div id="erro"> 
                <div id="quiz" class="progress bg-secondary"  style="height: 30px;">
                    <div class="progress-bar bg-success" id="myprogressBar" 
                        role="progressbar" style="width: 1%;" 
                        aria-valuenow="0" aria-valuemin="1" aria-valuemax="100"> 
                    </div>
                </div>
            </div> 
        </div> <!-- fim div card -->
            <div class="marcador">
                <div class="justify-content-center d-flex mb-1">
                        {% if questions.has_next %}
                            <button class="form-group btn btn-success" type="button" 
                                id="btnEnviar" onclick="capturaResposta()">  <b> CONFIRMAR </b> 
                            </button>
                            <button type="button" class="form-group btn btn-info " id="btnPaginas"> 
                                <b> {{ questions.number }} de {{ questions.paginator.num_pages }} </b>
                            </button>
                            <a href="?page={{ questions.next_page_number }}"> 
                                <button class="form-group btn btn-warning" 
                                    type="submit" id="btnProxima"> <b> PULAR </b> 
                                </button> 
                            </a>
                            <button type="button" class="form-group btn btn-danger ml-1"> 
                                <a href="{% url 'quizes:index' %}"> 
                                <i class="fa fa-home" aria-hidden="true"></i><b> CANCELAR </b></a>
                            </button>
                        {% else %} 
                            <button type="button" class="form-group btn btn-success"
                                data-toggle="modal" data-target="#quizResultModal" 
                                id="btnFinaliza"> <i class="fa fa-user" aria-hidden="false"></i> <b> FINALIZAR </b>
                            </button>
                            <button type="button" class="form-group btn btn-info"> 
                                 <b> {{ questions.number }} / {{ questions.paginator.num_pages }} </b> 
                            </button>
                            <button type="button" id="btnSalvar" class="form-group btn btn-primary" 
                                onclick="preparaSalvaDisc()"> <i class="fa fa-plus-square" aria-hidden="false"></i> 
                               <b> GRAVAR </b></button>
                            <button type="button" class="form-group btn btn-light" id="btnRelatorio"> 
                                    <a href="{% url 'result:resultado' %}">
                                    <i class="fa fa-info" aria-hidden="false"></i><b> PDF </b></a>
                            </button> 
                            <button type="button" class="form-group btn btn-dark ml-1"> 
                                <a href="{% url 'quizes:index' %}">
                                    <i class="fa fa-home" aria-hidden="false"></i> <b> MENU </b> </a>
                            </button> 
                            <input type="hidden" id="Url" data-url="{% url 'result:resultado' %}" />
                        {% endif %}
                </div>
            </div>
            <div class="marcador-topo mt-1">
                <ol> 
                    <li class="text-dark mt-1"> Responda conforme identifica-se com a pergunta. Conceito maior diz que mais encaixa-se com sua personalidade;  </li>
                    <li class="text-dark"> Defina apenas um valor. Exemplo: 1,2,3 ou 4. 
                        Notas repetidas não são permitidas na mesma questão;  </li>
                    <li class="text-dark"> É possível pular a alternativa, mas não será possível retornar;  </li>
                    <li class="text-dark"> Para o cálculo completo de seu perfil, por favor responda à todas as questões. </li>
                </ol> 
            </div>
    </div>


 <!-- Modal para o DISC -->
<div class="modal fade" id="quizResultModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="dialog">
      <div class="modal-content modal-content-centered">
        <div class="modal-header">
          <h6 class="modal-title text-center" id="exampleModalLabel">Relatório DISC - Seu perfil </h6>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" id="modal-body-confirm">
            <div class="h5  bg-danger   text-white text-center mb-1 mt-1" id="dominante">  </div> 
            <div class="h5  bg-info     text-dark text-center mb-1 mt-1"  id="influente"> </div> 
            <div class="h5  bg-success  text-white text-center mb-1 mt-1" id="estavel"> </div> 
            <div class="h5  bg-warning  text-center mb-1 mt-1"            id="cauteloso"> </div> 
            <hr class="divider">
            <div class="h4 bg-primary text-white text-center mb-4 mt-4" id="maiorPerfil">  </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal"> Retornar </button>
          <button type="button" id="start-button" class="btn btn-success" data-dismiss="modal" 
            onclick="preparaSalvaDisc()"> Salvar </button>
        </div>
      </div>
    </div>
</div>

</div>  <!-- fim row -->
</header> <!-- fim header -->

{% else %} <!-- Se não, atualize perfil -->

<header class="masthead">
	<div class="container px-4 px-lg-5 h-100 marcador-topo">
        <div class="h5 bg-primary border text-center text-white"> ::ATUALIZAÇÃO CADASTRAL:: </div>
        <hr class="divider">
		<div class="row gx-4 gx-lg-5 d-flex justify-content-center marcador-topo">
			
        <div class="justify-content-center mt-2">
            <h6> Caro(a) usuário(a), {{ request.user }}</h6>
            <hr>
            <ul>
                <li> <h6> Para melhor precisão do teste comportamental DISC, faz-se necessário preencher todos os dados pessoais; </h6> </li>
                <li> <h6> **Os dados: nome completo, nascimento, sexo, etnia (cor da pele), país e profissão são obrigatórios;</h6> </li>
                <li> <h6> Por favor, complete seu cadastro para prosseguir,
                <a href="{% url 'atualizar-dados' %}"><b>  acessando aqui </b> </a> ou em <u> atualizar </u>abaixo; </h6> </li> 
                <li> <h6> Caso não concorde, por favor
                    <a href="{% url 'quizes:ListaQuizes' %}"> <b> clique aqui </b> </a> para voltar ou em <u> cancelar </u>abaixo. </h6>
                </li>
                <hr> 
                    <p class="text-center text-dark"> **Estes dados alimentarão um modelo de aprendizado de máquina 
                    que poderá lhe ajudar em decisões de sua carreira profissional futuramente. </p> 
            </ul>   <hr>   
        </div>
            <div class="marcador">
                <div class="justify-content-center d-flex mb-1">
                    <a class="btn btn-success btn-md" href="{% url 'atualizar-dados' %}"> ATUALIZAR </a>
                    <a class="btn btn-danger btn-md ml-1" href="{% url 'quizes:ListaQuizes' %}"> CANCELAR </a>
                </div>
            </div>
        </div>
    </div>  
</header>     
{% endif %} <!-- FIM se perfil completo -->

{% endblock%} <!-- Fim block content -->


 


